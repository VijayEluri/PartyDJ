<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Party DJ</title>
   <link rel="stylesheet" type="text/css" href="style.css" />
   
   <!-- js -->
   <script src="js/prototype.js" type="text/javascript"></script>
   <script src="js/livepipe.js" type="text/javascript"></script>
   <script src="js/tabs.js" type="text/javascript"></script>
   <script language="javascript">
     var tabControl;
   </script>
   <script language="javascript">
     function updateNowPlaying() {
        new Ajax.Request('/player/queue/5', {
		   method: 'get',
		   onSuccess: function(transport) {
		      var json = transport.responseText.evalJSON();
			  var table = new Element('table').insert( 
			     new Element('thead')
				    .insert(new Element('th').update("#"))
				    .insert(new Element('th').update("Artist"))
				    .insert(new Element('th').update("Album"))
				    .insert(new Element('th').update("Song"))
				    .insert(new Element('th').update("Length"))
			  );
			  var tbody = new Element('tbody');
			  table.insert(tbody);
			  for (i = 0; i < json.length; i++) {
			     tbody.insert(new Element('tr')
				    .insert(new Element('td').update(i + 1))
				    .insert(new Element('td').update(json[i].metadata.artist))
				    .insert(new Element('td').update(json[i].metadata.album))
				    .insert(new Element('td').update(json[i].metadata.title))
				    .insert(new Element('td').update(json[i].metadata.length))
				 );
			  }
		      $('playQueue').update(table);
			  //IE sucks code
				if (Prototype.Browser.IE){
				   var ieRowNum = 0;
				   $$('table tbody > tr:nth-child(even)').each(
					  function(row){
						 Element.addClassName(row, 'evenRow');
					  }
				   );
				   $$('table tbody > tr:nth-child(odd)').each(
					  function(row){
						 Element.addClassName(row, "oddRow");
					  }
				   );
				}
		   }
	    });
		updateNowPlaying.delay(5);
	  }
   </script>
</head>

<body>
  <h1>Party DJ!</h1>
  
  <div id="nav">
	<ul id="tabMenu">
      <li class="tab"><a href="#nowPlaying">Now Playing</a></li>
      <li class="tab"><a href="#search">Search</a></li>
	</ul>
  </div>
  
  <div id="nowPlaying" class="tabContent">
    <h3>Now Playing:</h3>
	<div id="playQueue"></div>
  </div>
  <div id="search" class="tabContent">
    <h3>Search</h3>
  </div>
   <script language="javascript">
      tabControl = new Control.Tabs("tabMenu");
	  updateNowPlaying();
   </script>
</body>
</html>
